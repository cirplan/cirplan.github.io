<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>[è¯‘]cssæ€§èƒ½ - Cirplan</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="cirplan"><meta name=description content="cssæ€§èƒ½"><meta name=keywords content="css,performance"><link rel=canonical href=https://cirplan.me/post/2014/12-08-css-performance/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link href=/sass/main.min.4325dd250c3d3e29d579a819f16fd876adbc5a03b3a1b32d2eefe0a067e8f219.css rel=stylesheet><meta property="og:title" content="[è¯‘]cssæ€§èƒ½"><meta property="og:description" content="cssæ€§èƒ½"><meta property="og:type" content="article"><meta property="og:url" content="https://cirplan.me/post/2014/12-08-css-performance/"><meta property="article:section" content="post"><meta property="article:published_time" content="2014-12-08T21:32:59+08:00"><meta property="article:modified_time" content="2014-12-08T21:32:59+08:00"><meta itemprop=name content="[è¯‘]cssæ€§èƒ½"><meta itemprop=description content="cssæ€§èƒ½"><meta itemprop=datePublished content="2014-12-08T21:32:59+08:00"><meta itemprop=dateModified content="2014-12-08T21:32:59+08:00"><meta itemprop=wordCount content="1382"><meta itemprop=keywords content="css,performance,"><meta name=twitter:card content="summary"><meta name=twitter:title content="[è¯‘]cssæ€§èƒ½"><meta name=twitter:description content="cssæ€§èƒ½"></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>Cirplan</a></div><div class=mobile-navbar-icon id=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>ä¸»é¡µ</li></a><a href=/post/><li class=mobile-menu-item>å½’æ¡£</li></a><a href=/tags/><li class=mobile-menu-item>æ ‡ç­¾</li></a><a href=/categories/><li class=mobile-menu-item>åˆ†ç±»</li></a><a href=/about/><li class=mobile-menu-item>å…³äº</li></a><a href=https://github.com/cirplan><li class=mobile-menu-item>Github</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>Cirplan</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>ä¸»é¡µ</a></li><li class=menu-item><a class=menu-item-link href=/post/>å½’æ¡£</a></li><li class=menu-item><a class=menu-item-link href=/tags/>æ ‡ç­¾</a></li><li class=menu-item><a class=menu-item-link href=/categories/>åˆ†ç±»</a></li><li class=menu-item><a class=menu-item-link href=/about/>å…³äº</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/cirplan>Github</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>[è¯‘]cssæ€§èƒ½</h1><div class=post-meta><span class=post-time>2014-12-08</span><div class=post-category><a href=/categories/css/>css</a></div><span class=more-meta>çº¦ 1382 å­—</span>
<span class=more-meta>é¢„è®¡é˜…è¯» 3 åˆ†é’Ÿ</span></div></header><div class=post-outdated><div class=warn><p>ã€æ³¨æ„ã€‘æœ€åæ›´æ–°äº <span class=timeago datetime=2014-12-08T21:32:59 title=2014-12-08>2014-12-08, </span>ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p></div></div><div class=post-content><p>åŸæ–‡ï¼š<a href=https://dl.dropboxusercontent.com/u/39519/talks/cssperf/index.html>CSS Performance</a>ï¼ˆ2011å¹´æ–‡ç« ï¼Œæœ‰ç€å¾ˆèµçš„ç¿»è½¬æ•ˆæœï¼Œå‰ææ˜¯ç¥­å‡ºé«˜çº§æµè§ˆå™¨ï¼‰</p><p><strong>ç›®å½•</strong></p><ol><li>Reflowsï¼ˆé‡æ’ï¼‰</li><li>Hardware Accelerated Cssï¼ˆç¡¬ä»¶åŠ é€Ÿcssï¼‰</li><li>Avoiding Expensive Cssï¼ˆé¿å…é«˜æ¶ˆè€—cssï¼‰</li><li>Selector Perfï¼ˆé€‰æ‹©å™¨æ€§èƒ½ï¼‰</li><li>Style Matching Perfï¼ˆæ ·å¼åŒ¹é…æ€§èƒ½ï¼‰</li><li>Polyfills</li><li>Debuggingï¼ˆè°ƒè¯•ï¼‰</li></ol><h2 id=1-é‡æ’><strong>1. é‡æ’</strong></h2><p>å…ˆæ¥çœ‹çœ‹htmlé¡µé¢çš„æ¸²æŸ“ã€ç»˜åˆ¶æµç¨‹å›¾</p><p><img src=/post/2014/images/1208/render.png alt=render></p><ol><li>æ ¹æ®<code>Html</code>æ ‡ç­¾ç”Ÿæˆ<code>Dom</code>æ ‘ï¼ˆ<code>Dom tree</code>ï¼‰ï¼›æ ¹æ®é»˜è®¤çš„ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„æ ·å¼ç”Ÿæˆæ ·å¼ç»“æ„ï¼ˆ<code>Styles struct</code>ï¼‰</li><li>ç”Ÿæˆæ¸²æŸ“æ ‘ï¼ˆ<code>Render tree</code>ï¼‰</li><li>ç»˜åˆ¶é¡µé¢</li></ol><p>ä¸‹é¢æ˜¯é‡æ’çš„æ¸²æŸ“çŸ­è§†é¢‘ï¼š</p><video controls preload autobuffer width=860 height=510>
<source src=https://dl.dropboxusercontent.com/u/39519/talks/cssperf/assets/geckoreflow-mozillaorg.mp4 type=video/mp4><source src=https://dl.dropboxusercontent.com/u/39519/talks/cssperf/assets/geckoreflow-mozillaorg.webm type=video/webm></video><p>ä¸‹é¢ï¼Œå…ˆçœ‹çœ‹é‡ç»˜æœºåˆ¶ï¼šå¦‚ä½•ï¼ˆä¸ï¼‰è§¦å‘<code>WebKit</code>çš„å¸ƒå±€ï¼ˆ<a href=http://gent.ilcore.com/2011/03/how-not-to-trigger-layout-in-webkit.html>How (not) to trigger a layout in WebKit</a>ï¼‰ï¼ˆ2011ï¼‰ã€‚</p><p>ç®€å•è¯‘æ–‡ï¼š</p><p>è®¸å¤š<code>Web</code>å¼€å‘è€…æ„è¯†åˆ°ï¼Œä¸€æ®µ<code>js</code>è„šæœ¬åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œæ˜¯åœ¨è§¦å‘<code>DOM</code>çš„æ“ä½œè€Œä¸æ˜¯æ‰§è¡Œä»£ç æœ¬èº«ã€‚è¿™æ ·ä¸€ä¸ªæ½œåœ¨æ¶ˆè€—æ—¶é—´ï¼Œä»<code>Dom</code>æ ‘æ„å»ºæ¸²æŸ“æ ‘ï¼ˆ<code>Render tree</code>ï¼‰çš„è¿‡ç¨‹ï¼Œè¢«ç§°ä½œå¸ƒå±€ï¼ˆåˆç§°é‡æ’ï¼‰ã€‚çº¦åºå¤§è¶Šå¤æ‚çš„<code>Dom</code>æ ‘ï¼Œå°±ä¼šæ¶ˆè€—æ›´å¤šçš„æ—¶é—´ã€‚</p><p>ä¸€ä¸ªå¾ˆé‡è¦çš„æ–¹æ³•è®©é¡µé¢çš„ä¸å‡æ­»ï¼Œå°±æ˜¯è®©åˆ†å¼€çš„Domæ“ä½œæ”¾åœ¨ä¸€èµ·ã€‚</p><p>ex:</p><pre><code>// ä¸€èˆ¬ï¼Œè§¦å‘ä¸¤æ¬¡å¸ƒå±€
var newWidth = aDiv.offsetWidth + 10; // Read
aDiv.style.width = newWidth + 'px'; // Write
var newHeight = aDiv.offsetHeight + 10; // Read
aDiv.style.height = newHeight + 'px'; // Write

// æ›´å¥½, åªè§¦å‘ä¸€æ¬¡å¸ƒå±€
var newWidth = aDiv.offsetWidth + 10; // Read
var newHeight = aDiv.offsetHeight + 10; // Read
aDiv.style.width = newWidth + 'px'; // Write
aDiv.style.height = newHeight + 'px'; // Write
</code></pre><p>ç„¶åè¿™é‡Œå°±ä¼šæœ‰ä¸ªé—®é¢˜ï¼šä»€ä¹ˆæƒ…å†µä¼šè§¦å‘å¸ƒå±€ï¼Ÿä¸‹é¢æ˜¯æ•´ç†çš„ä¸€äº›å…ƒç´ å’Œæ–¹æ³•ï¼š</p><pre><code>Element
clientHeight, clientLeft, clientTop, clientWidth, focus(), getBoundingClientRect(), getClientRects(), innerText, offsetHeight, offsetLeft, offsetParent, offsetTop, offsetWidth, outerText, scrollByLines(), scrollByPages(), scrollHeight, scrollIntoView(), scrollIntoViewIfNeeded(), scrollLeft, scrollTop, scrollWidth

Frame, Image
height, width

Range
getBoundingClientRect(), getClientRects()

SVGLocatable
computeCTM(), getBBox()

SVGTextContent
getCharNumAtPosition(), getComputedTextLength(), getEndPositionOfChar(), getExtentOfChar(), getNumberOfChars(), getRotationOfChar(), getStartPositionOfChar(), getSubStringLength(), selectSubString()

SVGUse
instanceRoot

window
getComputedStyle(), scrollBy(), scrollTo(), scrollX, scrollY, webkitConvertPointFromNodeToPage(), webkitConvertPointFromPageToNode()
</code></pre><p>å½“ç„¶åˆ—å‡ºçš„è¿™äº›ä¸æ˜¯å…¨éƒ¨ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚æœ€å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡Chromeæˆ–è€…Firefoxæµè§ˆå™¨çš„è°ƒè¯•å™¨å»æŸ¥çœ‹ã€‚ï¼ˆç¿»è¯‘å®Œï¼‰</p><p>å¥½çš„ï¼Œå†å›åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹çœ‹ä»€ä¹ˆåŠ¨ä½œä¼šè§¦å‘é‡æ’ã€‚</p><ul><li>å¢åŠ ï¼Œåˆ é™¤ï¼Œæ›´æ–°<code>Dom</code>èŠ‚ç‚¹ã€‚</li><li>é€šè¿‡<code>display:none</code>éšè—å…ƒç´ ã€‚</li><li>å¯¹é¡µé¢ä¸Šçš„<code>Dom</code>å…ƒç´ è¿›è¡Œç§»åŠ¨ç­‰åŠ¨ç”»ã€‚</li><li>å¢åŠ æ ·å¼ï¼Œæˆ–è°ƒæ•´æ ·å¼å±æ€§ã€‚</li><li>ç”¨æˆ·æ”¹å˜çª—å£å¤§å°ï¼Œæ”¹å˜å­—ä½“å¤§å°ï¼Œæˆ–è€…æ»šåŠ¨é¡µé¢ã€‚</li></ul><h3 id=ç­–ç•¥>ç­–ç•¥ï¼š</h3><ul><li>åœ¨è§¦å‘é‡æ’åŠ¨ä½œå‰ï¼Œå¯¹<code>Dom</code>è¿›è¡Œæ‰¹é‡æ“ä½œã€‚</li><li>å¤åˆ¶èŠ‚ç‚¹çš„å±æ€§ï¼Œåœ¨å¤åˆ¶çš„èŠ‚ç‚¹é‡Œè¿›è¡Œæ“ä½œï¼Œåœ¨ä¸€æ¬¡äº¤æ¢è¿‡æ¥ã€‚</li><li>å…ˆç”¨<code>display:none</code>éšè—èŠ‚ç‚¹ï¼Œå†è¿›è¡Œå¤§é‡çš„æ“ä½œï¼Œå†é€šè¿‡<code>display</code>æ˜¾ç¤ºã€‚</li></ul><p>æ›´å¤šé‡æ’æ–‡ç« ï¼š</p><p><a href=http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/>Stoyan Stefanov on Reflow/Repaint</a></p><p><a href=http://calendar.perfplanet.com/2009/the-new-game-show-will-it-reflow/>The new game show: &ldquo;Will it reflow?&rdquo;</a></p><p><a href="http://www.browserscope.org/?category=reflow">Mozilla&rsquo;s David Baron on Browser Internals for Web Developers</a></p><p><a href="https://www.youtube.com/watch?v=a2_6bGNZ7bA">WebKit blog five-part series on rendering</a></p><h2 id=2ç¡¬ä»¶åŠ é€Ÿcss><strong>2.ç¡¬ä»¶åŠ é€Ÿcss</strong>##</h2><p>å……åˆ†åˆ©ç”¨<code>Css</code>çš„<code>transitions</code>å’Œ<code>transforms</code>è¾¾åˆ°æœ€ä¼˜çš„è´¨é‡ã€‚
è¿™æ–¹é¢ä¸»è¦åº”ç”¨äºæ‰‹æœºï¼Œioså’ŒAndroid</p><video controls preload autobuffer width=860 height=310>
<source src=https://dl.dropboxusercontent.com/u/39519/talks/cssperf/assets/translate3d.mp4 type=video/mp4><source src=https://dl.dropboxusercontent.com/u/39519/talks/cssperf/assets/translate3d.webm type=video/webm></video><h2 id=3é¿å…é«˜æ¶ˆè€—css><strong>3.é¿å…é«˜æ¶ˆè€—css</strong>##</h2><ul><li>@font-face</li><li>box-shadow</li><li>opacity compositing</li><li>gradients</li><li>text-align</li></ul><p>(è¿™éƒ¨åˆ†å¾…ç»­&mldr;)</p><h2 id=4é€‰æ‹©å™¨æ€§èƒ½><strong>4.é€‰æ‹©å™¨æ€§èƒ½</strong>##</h2><p>æµè§ˆå™¨é»˜è®¤æ˜¯ä»å³åˆ°å·¦ã€‚</p><p>ä¸‹é¢é€‰æ‹©å™¨å¼•æ“æ˜¯ä»å·¦åˆ°å³ï¼š</p><ul><li>Mootools</li><li>Sly</li><li>Peppy</li><li>Dojo Acme</li><li>Ext JS</li><li>Prototype.js</li></ul><p>ä¸‹é¢æ˜¯ä»å³åˆ°å·¦ï¼š</p><ul><li>Sizzle</li><li>YUI 3</li><li>NWMatcher</li><li>querySelectorAll</li></ul><p>é€‰æ‹©å™¨ä¼˜åŒ–</p><p>æ¨èç»„åˆæ˜¯ï¼š<code>tag .class</code>ï¼Œè®©æ ‡ç­¾åœ¨å·¦è¾¹ï¼Œå°½å¯èƒ½è®©classåœ¨å³è¾¹ã€‚</p><h2 id=5æ ·å¼åŒ¹é…æ€§èƒ½><strong>5.æ ·å¼åŒ¹é…æ€§èƒ½</strong>##</h2><p>å…³äºæ ·å¼åŒ¹é…ï¼Œè¯·çœ‹<a href=http://screwlewse.com/2010/08/different-css-techniques-and-their-performance/>æ ·å¼åŒ¹é…æ€§èƒ½</a>ã€‚</p><h2 id=6polyfills><strong>6.Polyfills</strong>##</h2><p>å…³äºPolyfillsçš„ä»‹ç»ï¼š</p><blockquote><p>Polyfilling æ˜¯ç”± RemySharp æå‡ºçš„ä¸€ä¸ªæœ¯è¯­ï¼Œå®ƒæ˜¯ç”¨æ¥æè¿°å¤åˆ¶ç¼ºå°‘çš„ API å’ŒAPI åŠŸèƒ½çš„è¡Œä¸ºã€‚ä½ å¯ä»¥ä½¿ç”¨å®ƒç¼–å†™å•ç‹¬åº”ç”¨çš„ä»£ç è€Œä¸ç”¨æ‹…å¿ƒå…¶ä»–æµè§ˆå™¨åŸç”Ÿæ˜¯ä¸æ˜¯æ”¯æŒã€‚å®é™…ä¸Šï¼Œpolyfillså¹¶ä¸æ˜¯æ–°æŠ€æœ¯ä¹Ÿä¸æ˜¯å’Œ HTML5 æ†ç»‘åˆ°ä¸€èµ·çš„ã€‚æˆ‘ä»¬å·²ç»åœ¨å¦‚json2.jsï¼Œie7-js å’Œä¸º IE æµè§ˆå™¨æä¾›é€æ˜ PNGæ”¯æŒçš„JSä¸­ä½¿ç”¨è¿‡äº†ã€‚è€Œå’Œç°åœ¨ polyfills çš„åŒºåˆ«å°±æ˜¯å»å¹´å¢åŠ çš„ HTML5 polyfillsã€‚</p></blockquote><p>ç›¸å…³ä¿¡æ¯ï¼š</p><ul><li><a href=http://selectivizr.com/>Selectivizr</a></li><li><a href=http://css3pie.com/>CSS3Pie</a></li><li><a href=https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills>Modernizr wiki list of polyfills</a></li></ul><h2 id=7è°ƒè¯•><strong>7.è°ƒè¯•</strong>##</h2><p>ä¸»è¦æ˜¯æ‰‹æœºç¡¬ä»¶æ–¹é¢çš„è°ƒè¯•ã€‚
ç›¸å…³ä¿¡æ¯ï¼š</p><ul><li><a href=http://peter.sh/experiments/chromium-command-line-switches/>All of Chrome&rsquo;s command line switches</a></li><li><a href=http://mir.aculo.us/2011/02/08/visualizing-webkits-hardware-acceleration/>Thomas Fuchs: Safari and iPhone Simulator CoreAnimation debugging info.</a></li><li><a href=http://www.html5rocks.com/en/tutorials/speed/html5/>HTML5Rocks: Improving the Performance of your HTML5 App</a></li></ul></div><div class=post-copyright><p class=copyright-item><span class=item-title>æ–‡ç« ä½œè€…</span>
<span class=item-content>cirplan</span></p><p class=copyright-item><span class=item-title>ä¸Šæ¬¡æ›´æ–°</span>
<span class=item-content>2014-12-08</span></p><p class=copyright-item><span class=item-title>æ–‡ç« é“¾æ¥</span>
<span class=item-content>https://cirplan.me/post/2014/12-08-css-performance/</span></p><p class=copyright-item><span class=item-title>è®¸å¯åè®®</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… (CC BY-NC-SA 4.0)</a></span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/css/>css</a>
<a href=/tags/performance/>performance</a></div><nav class=post-nav><a class=prev href=/post/2014/12-08-css-selector/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">[è¯‘]cssé€‰æ‹©å™¨æ¸²æŸ“ä¼˜åŒ–</span>
<span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span></a>
<a class=next href=/post/2014/12-05-css-specificity-wars/><span class="next-text nav-default">[è¯‘]å±‚å å’Œé€‰æ‹©å™¨çš„æ˜ç¡®åº¦--æƒé‡</span>
<span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=copyright><span class=copyright-year>&copy;
2013 -
2022<span class=heart>ğŸ¥•</span><span>cirplan</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script>window.onload=function(){const e="fixed-open",n="slideout-open",s="icon-click",t=document.querySelector("#mobile-navbar-icon");t.addEventListener("click",o=>{const i=document.querySelector("#mobile-navbar"),a=document.querySelector("#mobile-panel");i.classList.contains(e)?(i.classList.remove(e),a.classList.remove(e),t.classList.remove(s),document.documentElement.classList.remove(n)):(i.classList.add(e),a.classList.add(e),t.classList.add(s),document.documentElement.classList.add(n))})}</script></body></html>
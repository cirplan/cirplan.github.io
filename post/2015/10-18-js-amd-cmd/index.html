<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>JSæ¨¡å—åŒ–å¼€å‘2ï¼šAMDä¸CMDè§„èŒƒ - èƒ–èåœçš„èœå›­</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="èƒ–ä¹ä¹çš„èåœ"><meta name=description content="JSæ¨¡å—åŒ–å¼€å‘ä¹‹AMDä¸CMDè§„èŒƒ"><meta name=keywords content="js,module,amd,cmd"><link rel=canonical href=https://cirplan.github.io/post/2015/10-18-js-amd-cmd/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link href=/sass/main.min.13b755479625487471ed020b20c7d7f5fa3af757dd4c943c3aedb3ae08d2fe9f.css rel=stylesheet><meta property="og:title" content="JSæ¨¡å—åŒ–å¼€å‘2ï¼šAMDä¸CMDè§„èŒƒ"><meta property="og:description" content="JSæ¨¡å—åŒ–å¼€å‘ä¹‹AMDä¸CMDè§„èŒƒ"><meta property="og:type" content="article"><meta property="og:url" content="https://cirplan.github.io/post/2015/10-18-js-amd-cmd/"><meta property="article:section" content="post"><meta property="article:published_time" content="2015-10-08T00:36:33+08:00"><meta property="article:modified_time" content="2015-10-08T00:36:33+08:00"><meta itemprop=name content="JSæ¨¡å—åŒ–å¼€å‘2ï¼šAMDä¸CMDè§„èŒƒ"><meta itemprop=description content="JSæ¨¡å—åŒ–å¼€å‘ä¹‹AMDä¸CMDè§„èŒƒ"><meta itemprop=datePublished content="2015-10-08T00:36:33+08:00"><meta itemprop=dateModified content="2015-10-08T00:36:33+08:00"><meta itemprop=wordCount content="2414"><meta itemprop=keywords content="js,module,amd,cmd,"><meta name=twitter:card content="summary"><meta name=twitter:title content="JSæ¨¡å—åŒ–å¼€å‘2ï¼šAMDä¸CMDè§„èŒƒ"><meta name=twitter:description content="JSæ¨¡å—åŒ–å¼€å‘ä¹‹AMDä¸CMDè§„èŒƒ"></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>èåœèœå›­</a></div><div class=mobile-navbar-icon id=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>ä¸»é¡µ</li></a><a href=/post/><li class=mobile-menu-item>å½’æ¡£</li></a><a href=/tags/><li class=mobile-menu-item>æ ‡ç­¾</li></a><a href=/categories/><li class=mobile-menu-item>åˆ†ç±»</li></a><a href=https://github.com/cirplan><li class=mobile-menu-item>Github</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>èåœèœå›­</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>ä¸»é¡µ</a></li><li class=menu-item><a class=menu-item-link href=/post/>å½’æ¡£</a></li><li class=menu-item><a class=menu-item-link href=/tags/>æ ‡ç­¾</a></li><li class=menu-item><a class=menu-item-link href=/categories/>åˆ†ç±»</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/cirplan>Github</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>JSæ¨¡å—åŒ–å¼€å‘2ï¼šAMDä¸CMDè§„èŒƒ</h1><div class=post-meta><span class=post-time>2015-10-08</span><div class=post-category><a href=/categories/js/>JS</a></div><span class=more-meta>çº¦ 2414 å­—</span>
<span class=more-meta>é¢„è®¡é˜…è¯» 5 åˆ†é’Ÿ</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>æ–‡ç« ç›®å½•</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#æœ¬æ–‡å†…å®¹>æœ¬æ–‡å†…å®¹ï¼š</a></li><li><a href=#1-amdè§„èŒƒä»£è¡¨requirejs>1. AMDè§„èŒƒï¼ˆä»£è¡¨require.jsï¼‰</a><ul><li><a href=#id-åå­—>id åå­—</a></li><li><a href=#dependencies-ä¾èµ–>dependencies ä¾èµ–</a></li><li><a href=#factory-å·¥å‚æ–¹æ³•>factory å·¥å‚æ–¹æ³•</a></li><li><a href=#ç®€å•çš„-commonjs-è½¬æ¢>ç®€å•çš„ CommonJS è½¬æ¢</a></li></ul></li><li><a href=#2cmdè§„èŒƒä»£è¡¨seajs>2.CMDè§„èŒƒï¼ˆä»£è¡¨sea.jsï¼‰</a><ul><li><a href=#require>require</a></li><li><a href=#exports>exports</a></li><li><a href=#module>module</a></li></ul></li><li><a href=#3amdè§„èŒƒcmdè§„èŒƒçš„å¼‚åŒç‚¹>3.AMDè§„èŒƒCMDè§„èŒƒçš„å¼‚åŒç‚¹</a><ul><li><a href=#ç›¸åŒç‚¹>ç›¸åŒç‚¹</a></li><li><a href=#ä¸åŒç‚¹>ä¸åŒç‚¹</a><ul><li><a href=#1æ‰§è¡Œæ—¶æœº>1.æ‰§è¡Œæ—¶æœº</a></li><li><a href=#2ä¹¦å†™é£æ ¼>2.ä¹¦å†™é£æ ¼</a></li></ul></li></ul></li><li><a href=#end>End</a></li></ul></nav></div></div><div class=post-outdated><div class=warn><p>ã€æ³¨æ„ã€‘æœ€åæ›´æ–°äº <span class=timeago datetime=2015-10-08T00:36:33 title=2015-10-08>2015-10-08, </span>ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p></div></div><div class=post-content><p>æ¥ç€<a href=/post/2015/10-17-js-module/>ä¸Šä¸€ç¯‡</a>ï¼Œè¿™é‡Œè¯´ä¸‹AMDä¸CMDè§„èŒƒã€‚</p><h1 id=æœ¬æ–‡å†…å®¹>æœ¬æ–‡å†…å®¹ï¼š</h1><p>1.AMDè§„èŒƒ</p><p>2.CMDè§„èŒƒ</p><p>3.AMDè§„èŒƒCMDè§„èŒƒçš„å¼‚åŒç‚¹</p><h1 id=1-amdè§„èŒƒä»£è¡¨requirejs>1. AMDè§„èŒƒï¼ˆä»£è¡¨require.jsï¼‰</h1><p>AMDè§„èŒƒçš„è‹±æ–‡æ–‡æ¡£çœ‹<a href=https://github.com/amdjs/amdjs-api/wiki/AMD>è¿™é‡Œ</a>ï¼Œä¸­æ–‡ç‰ˆçœ‹<a href=https://github.com/amdjs/amdjs-api/wiki/AMD-(%E4%B8%AD%E6%96%87%E7%89%88)>è¿™é‡Œ</a>ï¼ˆé€‰æ‹©ç»†çœ‹æ–‡æ¡£çš„è¯ï¼Œä¸‹é¢ä¸ç”¨çœ‹äº†ï¼‰ã€‚AMDå…¨ç§°æ˜¯Asynchronous Module Definitionï¼ˆå¼‚æ­¥æ¨¡å—å®šä¹‰è§„èŒƒï¼‰ï¼Œè§„å®šäº†æ¨¡å—ä¸æ¨¡å—ä¹‹é—´æ˜¯å¼‚æ­¥åŠ è½½çš„ï¼Œ
è¿™å’Œæµè§ˆå™¨çš„å¼‚æ­¥åŠ è½½æ¨¡å—çš„ç¯å¢ƒåˆšå¥½é€‚åº”ï¼ˆæµè§ˆå™¨åŒæ­¥åŠ è½½æ¨¡å—ä¼šå¯¼è‡´æ€§èƒ½ã€å¯ç”¨æ€§ã€è°ƒè¯•å’Œè·¨åŸŸè®¿é—®ç­‰é—®é¢˜ï¼‰ã€‚</p><p>è¯¥è§„èŒƒåªå®šä¹‰äº†ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼š</p><pre><code>define(id?, dependencies?, factory);
</code></pre><h2 id=id-åå­—>id åå­—</h2><ul><li>ç±»å‹ï¼šå­—ç¬¦ä¸²ï¼›</li><li>ç‰¹ç‚¹ï¼šå”¯ä¸€ï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸ºè„šæœ¬åå­—ã€‚</li></ul><h2 id=dependencies-ä¾èµ–>dependencies ä¾èµ–</h2><ul><li>ç±»å‹ï¼šæ•°ç»„ï¼›</li><li>æ‰§è¡Œé¡ºåºï¼šä¾èµ–æ¨¡å—å¿…é¡»æ ¹æ®æ¨¡å—çš„å·¥å‚æ–¹æ³•ä¼˜å…ˆçº§æ‰§è¡Œï¼ˆä¾èµ–å°‘çš„å…ˆæ‰§è¡Œï¼‰ï¼Œå¹¶ä¸”æ‰§è¡Œçš„ç»“æœåº”è¯¥æŒ‰ç…§ä¾èµ–æ•°ç»„ä¸­çš„ä½ç½®é¡ºåºä»¥å‚æ•°çš„å½¢å¼ä¼ å…¥ï¼ˆå®šä¹‰ä¸­æ¨¡å—çš„ï¼‰å·¥å‚æ–¹æ³•ä¸­ï¼›</li><li>æ¨¡å—å‘½åï¼šå¦‚æœæ˜¯ç›¸å¯¹çš„ï¼Œåº”è¯¥è§£æä¸ºç›¸å¯¹å®šä¹‰ä¸­çš„æ¨¡å—ã€‚</li><li>å…³é”®å­—ï¼š ä¸‰ç§ç‰¹æ®Šçš„ä¾èµ–å…³é”®å­—<code>require</code>,<code>exports</code>, <code>module</code>ï¼Œæ˜¯å¯é€‰çš„ï¼Œå¦‚æœå¿½ç•¥æ­¤å‚æ•°ï¼Œå®ƒåº”è¯¥é»˜è®¤ä¸º[&ldquo;require&rdquo;, &ldquo;exports&rdquo;, &ldquo;module&rdquo;]ã€‚
ç„¶è€Œï¼Œå¦‚æœå·¥å‚æ–¹æ³•çš„å½¢å‚ä¸ªæ•°å°äº3ï¼ŒåŠ è½½å™¨ä¼šé€‰æ‹©ä»¥å‡½æ•°æŒ‡å®šçš„å‚æ•°ä¸ªæ•°è°ƒç”¨å·¥å‚æ–¹æ³•ã€‚</li></ul><p>åˆ›å»ºä¸€ä¸ªåä¸º"alpha"çš„æ¨¡å—ï¼Œä½¿ç”¨äº†requireï¼Œexportsï¼Œå’Œåä¸º"beta"çš„æ¨¡å—:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=s2>&#34;alpha&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;require&#34;</span><span class=p>,</span> <span class=s2>&#34;exports&#34;</span><span class=p>,</span> <span class=s2>&#34;beta&#34;</span><span class=p>],</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>beta</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>exports</span><span class=p>.</span><span class=nx>verb</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>beta</span><span class=p>.</span><span class=nx>verb</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>//Or:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;beta&#34;</span><span class=p>).</span><span class=nx>verb</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=factory-å·¥å‚æ–¹æ³•>factory å·¥å‚æ–¹æ³•</h2><ul><li>ç±»å‹ï¼šå‡½æ•°æˆ–å¯¹è±¡ï¼›</li><li>ç‰¹ç‚¹ï¼šå‡½æ•°åªæ‰§è¡Œä¸€æ¬¡</li></ul><p>ä¸€ä¸ªæ²¡æœ‰ä¾èµ–æ€§çš„æ¨¡å—å¯ä»¥ç›´æ¥å®šä¹‰å¯¹è±¡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>add</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>x</span> <span class=o>+</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ç®€å•çš„-commonjs-è½¬æ¢>ç®€å•çš„ CommonJS è½¬æ¢</h2><p>ä¸ºäº†å‘CommonJSé æ‹¢è€ŒåŠ çš„æ–¹æ³•ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=nx>b</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;b&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>exports</span><span class=p>.</span><span class=nx>action</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†è¿™ä¼šè¢«è½¬æ¢æˆè§„èŒƒæ¨¡å¼å†æ‰§è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>([</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>],</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=nx>exports</span><span class=p>.</span><span class=nx>action</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨require.jsï¼ˆv2.1.20 line2052ï¼‰ä¸­çš„å®ç°å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>//If no name, and callback is a function, then figure out if it a
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>//CommonJS thing with dependencies.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>deps</span> <span class=o>&amp;&amp;</span> <span class=nx>isFunction</span><span class=p>(</span><span class=nx>callback</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>deps</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=c1>//Remove comments from the callback string,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//look for require calls, and pull them into the dependencies,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//but only if there are function args.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>callback</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>callback</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>commentRegExp</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>cjsRequireRegExp</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>match</span><span class=p>,</span> <span class=nx>dep</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>deps</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>dep</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//May be a CommonJS thing even without require calls, but still
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//could use exports, and module. Avoid doing exports and module
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//work though if it just needs require.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//REQUIRES the function to expect the CommonJS variables in the
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//order listed below.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>deps</span> <span class=o>=</span> <span class=p>(</span><span class=nx>callback</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>1</span> <span class=o>?</span> <span class=p>[</span><span class=s1>&#39;require&#39;</span><span class=p>]</span> <span class=o>:</span> <span class=p>[</span><span class=s1>&#39;require&#39;</span><span class=p>,</span> <span class=s1>&#39;exports&#39;</span><span class=p>,</span> <span class=s1>&#39;module&#39;</span><span class=p>]).</span><span class=nx>concat</span><span class=p>(</span><span class=nx>deps</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå› ä¸ºè„šæœ¬å¤§å°çš„é™åˆ¶æˆ–å‡½æ•°ä¸æ”¯æŒtoStringæ–¹æ³•ï¼ˆOpera Mobileæ˜¯å·²çŸ¥çš„ä¸æ”¯æŒå‡½æ•°çš„toStringæ–¹æ³•ï¼‰ï¼Œæ¨¡å—åŠ è½½å™¨å¯ä»¥é€‰æ‹©æ‰«æä¸æ‰«æä¾èµ–æ€§ã€‚
å¦‚æœæœ‰ä¾èµ–å‚æ•°ï¼Œæ¨¡å—åŠ è½½å™¨ä¸åº”è¯¥åœ¨å·¥å‚æ–¹æ³•ä¸­æ‰«æä¾èµ–æ€§ã€‚</p><h1 id=2cmdè§„èŒƒä»£è¡¨seajs>2.CMDè§„èŒƒï¼ˆä»£è¡¨sea.jsï¼‰</h1><p>CMD(Common Module Definition)è§„èŒƒæˆ³<a href=https://github.com/seajs/seajs/issues/242>è¿™é‡Œ</a>ã€‚è¯¥è§„èŒƒè§„å®šä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå®šä¹‰çš„å‡½æ•°å¦‚ä¸‹ï¼š</p><pre><code>define(factory);
</code></pre><ul><li>defineæ˜¯å…¨å±€å‡½æ•°ï¼›</li><li>factoryå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å­—ç¬¦ä¸²ï¼›</li><li>factoryä¸ºå‡½æ•°æ—¶ï¼Œé»˜è®¤ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š<code>require</code>ã€<code>exports</code> å’Œ <code>module</code>;</li></ul><p>ex:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// æ¨¡å—ä»£ç 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>CMDä¹Ÿæ”¯æŒå¦‚ä¸‹å†™æ³•ï¼š</p><pre><code>define(id?, deps?, factory)
</code></pre><p>å­—ç¬¦ä¸² id è¡¨ç¤ºæ¨¡å—æ ‡è¯†ï¼Œæ•°ç»„ deps æ˜¯æ¨¡å—ä¾èµ–ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=s1>&#39;hello&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;jquery&#39;</span><span class=p>],</span> <span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// æ¨¡å—ä»£ç 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†æ˜¯ï¼Œå¸¦ id å’Œ deps å‚æ•°çš„ define ç”¨æ³•ä¸å±äº CMD è§„èŒƒï¼Œè€Œå±äº <a href=https://github.com/cmdjs/specification/blob/master/draft/transport.md>Modules/Transport</a> è§„èŒƒã€‚</p><p>ä¸‹é¢åˆ†åˆ«è¯´è¯´<code>require</code>ï¼Œ<code>exports</code>ï¼Œ<code>module</code>ã€‚</p><h2 id=require>require</h2><p><code>require</code>æ˜¯ factory å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ¥å— æ¨¡å—æ ‡è¯† ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œç”¨æ¥è·å–å…¶ä»–æ¨¡å—æä¾›çš„æ¥å£ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// è·å–æ¨¡å— a çš„æ¥å£
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// è°ƒç”¨æ¨¡å— a çš„æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>a</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><code>require.async</code> require.async(id, callback?) æ–¹æ³•ç”¨æ¥åœ¨æ¨¡å—å†…éƒ¨å¼‚æ­¥åŠ è½½æ¨¡å—ï¼Œå¹¶åœ¨åŠ è½½å®Œæˆåæ‰§è¡ŒæŒ‡å®šå›è°ƒã€‚callback å‚æ•°å¯é€‰ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// å¼‚æ­¥åŠ è½½ä¸€ä¸ªæ¨¡å—ï¼Œåœ¨åŠ è½½å®Œæˆæ—¶ï¼Œæ‰§è¡Œå›è°ƒ
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>require</span><span class=p>.</span><span class=kr>async</span><span class=p>(</span><span class=s1>&#39;./b&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// å¼‚æ­¥åŠ è½½å¤šä¸ªæ¨¡å—ï¼Œåœ¨åŠ è½½å®Œæˆæ—¶ï¼Œæ‰§è¡Œå›è°ƒ
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>require</span><span class=p>.</span><span class=kr>async</span><span class=p>([</span><span class=s1>&#39;./c&#39;</span><span class=p>,</span> <span class=s1>&#39;./d&#39;</span><span class=p>],</span> <span class=kd>function</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>c</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>d</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=exports>exports</h2><p><code>exports</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å‘å¤–æä¾›æ¨¡å—æ¥å£ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// å¯¹å¤–æä¾› foo å±æ€§
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>exports</span><span class=p>.</span><span class=nx>foo</span> <span class=o>=</span> <span class=s1>&#39;bar&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// å¯¹å¤–æä¾› doSomething æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>exports</span><span class=p>.</span><span class=nx>doSomething</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>é™¤äº†ç»™ exports å¯¹è±¡å¢åŠ æˆå‘˜ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ return ç›´æ¥å‘å¤–æä¾›æ¥å£ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// é€šè¿‡ return ç›´æ¥æä¾›æ¥å£
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>foo</span><span class=o>:</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>doSomething</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>æç¤ºï¼šexports ä»…ä»…æ˜¯ module.exports çš„ä¸€ä¸ªå¼•ç”¨ã€‚åœ¨ factory å†…éƒ¨ç»™ exports é‡æ–°èµ‹å€¼æ—¶ï¼Œå¹¶ä¸ä¼šæ”¹å˜ module.exports çš„å€¼ã€‚å› æ­¤ç»™ exports èµ‹å€¼æ˜¯æ— æ•ˆçš„ï¼Œä¸èƒ½ç”¨æ¥æ›´æ”¹æ¨¡å—æ¥å£ã€‚</p><h2 id=module>module</h2><p><code>module</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸Šé¢å­˜å‚¨äº†ä¸å½“å‰æ¨¡å—ç›¸å…³è”çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•ã€‚</p><p><code>module.exports</code> å½“å‰æ¨¡å—å¯¹å¤–æä¾›çš„æ¥å£ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// exports æ˜¯ module.exports çš„ä¸€ä¸ªå¼•ç”¨
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>===</span> <span class=nx>exports</span><span class=p>);</span> <span class=c1>// true
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=c1>// é‡æ–°ç»™ module.exports èµ‹å€¼
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>SomeClass</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// exports ä¸å†ç­‰äº module.exports
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>===</span> <span class=nx>exports</span><span class=p>);</span> <span class=c1>// false
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„ï¼šå¯¹ module.exports çš„èµ‹å€¼éœ€è¦åŒæ­¥æ‰§è¡Œï¼Œä¸èƒ½æ”¾åœ¨å›è°ƒå‡½æ•°é‡Œã€‚ä¸‹é¢è¿™æ ·æ˜¯ä¸è¡Œçš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// x.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// é”™è¯¯ç”¨æ³•
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>a</span><span class=o>:</span> <span class=s2>&#34;hello&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>CMDç»å¸¸ä½¿ç”¨çš„ API åªæœ‰ <code>define, require, require.async, exports, module.exports</code> è¿™äº”ä¸ªã€‚å…¶ä»–è¯·çœ‹è§„èŒƒã€‚</p><h1 id=3amdè§„èŒƒcmdè§„èŒƒçš„å¼‚åŒç‚¹>3.AMDè§„èŒƒCMDè§„èŒƒçš„å¼‚åŒç‚¹</h1><h2 id=ç›¸åŒç‚¹>ç›¸åŒç‚¹</h2><p>AMDä¸CMDçš„ç›¸åŒç‚¹æ˜¯ï¼šéƒ½æ˜¯ <strong>å¼‚æ­¥æå‰åŠ è½½</strong>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// AMD 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>([</span><span class=s1>&#39;./a&#39;</span><span class=p>,</span> <span class=s1>&#39;./b&#39;</span><span class=p>],</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=c1>//åœ¨æ­¤æ—¶æ¨¡å—aå’Œbéƒ½å·²åŠ è½½å®Œ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// CMD
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//åœ¨æ­¤æ—¶æ¨¡å—aå’Œbéƒ½å·²åŠ è½½å®Œ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./a&#39;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>    <span class=nx>a</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./b&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ä¸åŒç‚¹>ä¸åŒç‚¹</h2><p>è€Œä¸¤è€…çš„åŒºåˆ«ï¼Œåœ¨ä¸Šä¸€ç¯‡ä¸­çš„AMDå’ŒCommonJSçš„åŒºåˆ«å·²ç»è¯´äº†ä¸€éƒ¨åˆ†ã€‚ç‰ä¼¯åœ¨<a href=http://www.zhihu.com/question/20351507/answer/14859415>çŸ¥ä¹</a>ä¹Ÿæœ‰å›ç­”ï¼Œæˆ–è€…çœ‹<a href=https://github.com/seajs/seajs/issues/277>è¿™é‡Œ</a>ã€‚ä¸»è¦æœ‰ä¿©ä¸ªï¼Œä¸€ä¸ªæ˜¯æ‰§è¡Œæ—¶æœºä¸åŒï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯ä¹¦å†™é£æ ¼ä¸åŒã€‚</p><h3 id=1æ‰§è¡Œæ—¶æœº>1.æ‰§è¡Œæ—¶æœº</h3><p>AMDæ˜¯ <strong>æå‰æ‰§è¡Œ</strong>ï¼ŒCMDæ˜¯ <strong>å»¶è¿Ÿæ‰§è¡Œ</strong>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// AMD 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>([</span><span class=s1>&#39;./a&#39;</span><span class=p>],</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨è¿™ä¹‹å‰aå·²ç»æ‰§è¡Œå®Œå¹¶è¿”å›
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>a</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>()</span><span class=err>ï¼›</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// CMD
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./a&#39;</span><span class=p>);</span> <span class=c1>// æ¨¡å—aåœ¨æ­¤æ—¶æ‰æ‰§è¡Œ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>a</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2ä¹¦å†™é£æ ¼>2.ä¹¦å†™é£æ ¼</h3><p>CMD æ¨å´‡<strong>ä¾èµ–å°±è¿‘</strong>ï¼ŒAMD æ¨å´‡<strong>ä¾èµ–å‰ç½®</strong>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// CMD
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>require</span><span class=p>,</span> <span class=nx>exports</span><span class=p>,</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./a&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>a</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ­¤å¤„ç•¥å» 100 è¡Œ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./b&#39;</span><span class=p>);</span> <span class=c1>// ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>b</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ... 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// AMD é»˜è®¤æ¨èçš„æ˜¯
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>([</span><span class=s1>&#39;./a&#39;</span><span class=p>,</span> <span class=s1>&#39;./b&#39;</span><span class=p>],</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// ä¾èµ–å¿…é¡»ä¸€å¼€å§‹å°±å†™å¥½
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>a</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ­¤å¤„ç•¥å» 100 è¡Œ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>b</span><span class=p>.</span><span class=nx>doSomething</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=end>End</h1><p>é€‰æ‹©AMDè¿˜æ˜¯CMDè¦çœ‹é¡¹ç›®çš„éœ€æ±‚å’Œè‡ªå·±å¯¹å†™æ³•çš„åå¥½ï¼Œå¹¶æ²¡æœ‰ç»å¯¹è¯´å“ªä¸ªæ¯”å“ªä¸ªå¥½ã€‚require.jsæˆåè¾ƒæ—©ï¼Œäººæ°”æ¯”è¾ƒé«˜ã€‚sea.jså°è€Œä¼˜é›…ï¼Œ
æ–‡æ¡£æ”¯æŒä¹Ÿæ¯”è¾ƒå¥½ï¼Œå›½å†…è¿˜æ˜¯æœ‰æ¯”è¾ƒå¤šäººä½¿ç”¨çš„ã€‚</p><p>ä¸‹é¢ä»‹ç»<code>require.js</code>çš„ä½¿ç”¨ï¼Œè¯·çœ‹ä¸‹ä¸€ç¯‡ï¼š<a href=/post/2015/10-19-js-requirejs/>require.jsçš„ä½¿ç”¨ä»¥åŠå‹ç¼©ç­–ç•¥</a></p></div><footer class=post-footer><div class=post-tags><a href=/tags/js/>js</a>
<a href=/tags/module/>module</a>
<a href=/tags/amd/>amd</a>
<a href=/tags/cmd/>cmd</a></div><nav class=post-nav><a class=prev href=/post/2015/10-19-js-requirejs/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">JSæ¨¡å—åŒ–å¼€å‘3ï¼šrequire.jsçš„ä½¿ç”¨ä»¥åŠå‹ç¼©ç­–ç•¥</span>
<span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span></a>
<a class=next href=/post/2015/10-17-js-module/><span class="next-text nav-default">JSæ¨¡å—åŒ–å¼€å‘1ï¼šå†å²</span>
<span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=cirplan/cirplan.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=copyright><span class=copyright-year>&copy;
2015 -
2022<span class=heart>ğŸ¥•</span><span>èƒ–ä¹ä¹çš„èåœ</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script>window.onload=function(){const e="fixed-open",n="slideout-open",s="icon-click",t=document.querySelector("#mobile-navbar-icon");t.addEventListener("click",o=>{const i=document.querySelector("#mobile-navbar"),a=document.querySelector("#mobile-panel");i.classList.contains(e)?(i.classList.remove(e),a.classList.remove(e),t.classList.remove(s),document.documentElement.classList.remove(n)):(i.classList.add(e),a.classList.add(e),t.classList.add(s),document.documentElement.classList.add(n))})}</script></body></html>